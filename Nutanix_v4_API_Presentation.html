<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutanix v4 APIs: Automating VM Category Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #333;
            overflow-x: hidden;
        }
        
        .presentation-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }
        
        .slide {
            padding: 60px;
            min-height: 100vh;
            display: none;
            position: relative;
        }
        
        .slide.active {
            display: block;
        }
        
        .slide h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-align: center;
            border-bottom: 3px solid #2a5298;
            padding-bottom: 20px;
        }
        
        .slide h2 {
            color: #2a5298;
            font-size: 2em;
            margin-bottom: 25px;
            margin-top: 30px;
        }
        
        .slide h3 {
            color: #1e3c72;
            font-size: 1.5em;
            margin-bottom: 20px;
            margin-top: 25px;
        }
        
        .slide p, .slide li {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .slide ul {
            margin-left: 30px;
            margin-bottom: 20px;
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        
        .workflow-box {
            background: #e7f3ff;
            border: 2px solid #2a5298;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .rest-method {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .get { background: #28a745; }
        .post { background: #007bff; }
        .put { background: #ffc107; color: #333; }
        .delete { background: #dc3545; }
        
        .navigation {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 1000;
        }
        
        .nav-btn {
            padding: 10px 20px;
            background: #2a5298;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }
        
        .nav-btn:hover {
            background: #1e3c72;
        }
        
        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .slide-counter {
            position: absolute;
            bottom: 20px;
            right: 30px;
            color: #666;
            font-size: 0.9em;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .excel-demo {
            background: #f0f8f0;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .api-flow {
            background: #fff5f5;
            border: 2px solid #dc3545;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #2a5298;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background: #2a5298;
            color: white;
        }
        
        tr:nth-child(even) {
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        
        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>Nutanix v4 APIs</h1>
            <div style="text-align: center; margin-top: 50px;">
                <h2>Automating VM Category Management with REST APIs</h2>
                <h3 style="margin-top: 50px; color: #666;">Using PowerShell, Python & Excel for Enterprise Automation</h3>
                <div style="margin-top: 80px; font-size: 1.2em; color: #555;">
                    <p><strong>Educational Workshop</strong></p>
                    <p>Understanding REST APIs, ExtIds, ETags, and Validation Workflows</p>
                </div>
            </div>
            <div class="slide-counter">1 / 12</div>
        </div>

        <!-- Slide 2: Agenda -->
        <div class="slide">
            <h1>Learning Objectives</h1>
            <h2>What We'll Cover Today</h2>
            <ul style="font-size: 1.3em; line-height: 2;">
                <li><strong>REST API Fundamentals</strong> - HTTP methods, headers, status codes</li>
                <li><strong>Nutanix v4 API Architecture</strong> - Endpoints, authentication, data models</li>
                <li><strong>Resource Identification</strong> - ExtIds and unique identifiers</li>
                <li><strong>Concurrency Control</strong> - ETags and optimistic locking</li>
                <li><strong>Excel-Driven Automation</strong> - User-friendly parameter entry</li>
                <li><strong>Validation Workflows</strong> - Pre-flight checks and error handling</li>
                <li><strong>Real-World Implementation</strong> - PowerShell and Python scripts</li>
            </ul>
            <div class="highlight">
                <strong>Goal:</strong> Build confidence in designing and implementing API-driven automation solutions that are both powerful and user-friendly.
            </div>
            <div class="slide-counter">2 / 12</div>
        </div>

        <!-- Slide 3: REST API Basics -->
        <div class="slide">
            <h1>REST API Fundamentals</h1>
            <h2>REpresentational State Transfer</h2>
            
            <h3>Core HTTP Methods</h3>
            <table>
                <tr>
                    <th>Method</th>
                    <th>Purpose</th>
                    <th>Idempotent</th>
                    <th>Example Use</th>
                </tr>
                <tr>
                    <td><span class="rest-method get">GET</span></td>
                    <td>Retrieve data</td>
                    <td>‚úì Yes</td>
                    <td>Fetch VM details</td>
                </tr>
                <tr>
                    <td><span class="rest-method post">POST</span></td>
                    <td>Create/Action</td>
                    <td>‚úó No</td>
                    <td>Associate categories</td>
                </tr>
                <tr>
                    <td><span class="rest-method put">PUT</span></td>
                    <td>Update/Replace</td>
                    <td>‚úì Yes</td>
                    <td>Update VM config</td>
                </tr>
                <tr>
                    <td><span class="rest-method delete">DELETE</span></td>
                    <td>Remove</td>
                    <td>‚úì Yes</td>
                    <td>Remove categories</td>
                </tr>
            </table>

            <h3>Key HTTP Headers</h3>
            <div class="code-block">
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
Content-Type: application/json
If-Match: "etag-value-here"
NTNX-Request-Id: 550e8400-e29b-41d4-a716-446655440000
            </div>

            <div class="slide-counter">3 / 12</div>
        </div>

        <!-- Slide 4: HTTP Status Codes -->
        <div class="slide">
            <h1>Understanding HTTP Status Codes</h1>
            <h2>What Your API is Telling You</h2>
            
            <div class="two-column">
                <div>
                    <h3>Success Codes (2xx)</h3>
                    <ul>
                        <li><strong>200 OK</strong> - GET request successful</li>
                        <li><strong>201 Created</strong> - Resource created</li>
                        <li><strong>202 Accepted</strong> - Async operation started</li>
                        <li><strong>204 No Content</strong> - Operation successful, no data returned</li>
                    </ul>
                    
                    <h3>Client Error Codes (4xx)</h3>
                    <ul>
                        <li><strong>400 Bad Request</strong> - Invalid syntax/data</li>
                        <li><strong>401 Unauthorized</strong> - Authentication failed</li>
                        <li><strong>403 Forbidden</strong> - Access denied</li>
                        <li><strong>404 Not Found</strong> - Resource doesn't exist</li>
                        <li><strong>409 Conflict</strong> - Resource state conflict</li>
                        <li><strong>412 Precondition Failed</strong> - ETag mismatch</li>
                    </ul>
                </div>
                <div>
                    <h3>Server Error Codes (5xx)</h3>
                    <ul>
                        <li><strong>500 Internal Server Error</strong> - Server-side error</li>
                        <li><strong>502 Bad Gateway</strong> - Upstream error</li>
                        <li><strong>503 Service Unavailable</strong> - Temporary unavailability</li>
                    </ul>
                    
                    <div class="highlight">
                        <strong>Pro Tip:</strong> Always handle these status codes in your automation scripts. A 412 response indicates an ETag conflict - another process may have modified the resource!
                    </div>
                </div>
            </div>

            <div class="workflow-box">
                <h3>In Our Scripts:</h3>
                <div class="code-block">
if post_response and post_response.status_code == 202:
    print("ACCEPTED: Operation started successfully")
    # Extract new ETag and update Excel
else:
    print(f"FAILED: Status code {post_response.status_code}")
    # Log error and update Excel with failure status
                </div>
            </div>

            <div class="slide-counter">4 / 12</div>
        </div>

        <!-- Slide 5: Nutanix v4 API Overview -->
        <div class="slide">
            <h1>Nutanix v4 API Architecture</h1>
            <h2>Modern, Consistent, Resource-Centric Design</h2>
            
            <h3>API Structure</h3>
            <div class="code-block">
https://prism-central.example.com:9440/api/
‚îú‚îÄ‚îÄ vmm/v4.1/ahv/config/vms              # Virtual Machine Management
‚îú‚îÄ‚îÄ prism/v4.1/config/categories         # Category Configuration  
‚îú‚îÄ‚îÄ prism/v4.1/management/clusters       # Cluster Management
‚îî‚îÄ‚îÄ storage/v4.1/config/volumes          # Storage Configuration
            </div>

            <div class="two-column">
                <div>
                    <h3>Key Characteristics</h3>
                    <ul>
                        <li><strong>Resource-Centric:</strong> Each resource has a unique ExtId</li>
                        <li><strong>Stateless:</strong> Each request is independent</li>
                        <li><strong>Versioned:</strong> v4.1 ensures API stability</li>
                        <li><strong>Consistent:</strong> Similar patterns across services</li>
                        <li><strong>Secure:</strong> Built-in authentication and authorization</li>
                    </ul>
                </div>
                <div>
                    <h3>Our Use Case Endpoints</h3>
                    <div class="api-flow">
                        <p><span class="rest-method get">GET</span><br>
                        <code>/vmm/v4.1/ahv/config/vms/{extId}</code><br>
                        <em>Retrieve VM details and current ETag</em></p>
                        
                        <p><span class="rest-method post">POST</span><br>
                        <code>/vmm/v4.1/ahv/config/vms/{extId}/$actions/associate-categories</code><br>
                        <em>Associate categories with VM</em></p>
                        
                        <p><span class="rest-method get">GET</span><br>
                        <code>/prism/v4.1/config/categories</code><br>
                        <em>List all available categories</em></p>
                    </div>
                </div>
            </div>

            <div class="slide-counter">5 / 12</div>
        </div>

        <!-- Slide 6: ExtIds Deep Dive -->
        <div class="slide">
            <h1>Understanding ExtIds</h1>
            <h2>External Identifiers - Your Key to Resource Management</h2>
            
            <h3>What are ExtIds?</h3>
            <div class="highlight">
                <strong>ExtId (External Identifier):</strong> A unique, immutable identifier for resources in Nutanix. Unlike names which can change, ExtIds provide a stable reference for API operations.
            </div>

            <div class="two-column">
                <div>
                    <h3>ExtId Characteristics</h3>
                    <ul>
                        <li><strong>Unique:</strong> Globally unique within the cluster</li>
                        <li><strong>Immutable:</strong> Never changes during resource lifetime</li>
                        <li><strong>UUID Format:</strong> Typically UUID v4 format</li>
                        <li><strong>API-Friendly:</strong> Used in all v4 API endpoints</li>
                        <li><strong>Cross-Reference:</strong> Links resources across services</li>
                    </ul>
                    
                    <h3>Example ExtIds</h3>
                    <div class="code-block">
VM ExtId:
550e8400-e29b-41d4-a716-446655440000

Category ExtId:
f47ac10b-58cc-4372-a567-0e02b2c3d479
                    </div>
                </div>
                <div>
                    <h3>Why ExtIds Matter</h3>
                    <div class="workflow-box">
                        <p><strong>Problem:</strong> VM named "WebServer01" could be renamed to "WebServer-Prod01"</p>
                        <p><strong>Solution:</strong> ExtId remains constant regardless of name changes</p>
                    </div>
                    
                    <h3>Retrieving ExtIds</h3>
                    <div class="code-block">
# PowerShell - Extract ExtId from API response
$vmExtId = $vm.metadata.extId

# Python - Same concept
vm_extid = vm_data['metadata']['extId']
                    </div>
                    
                    <div class="excel-demo">
                        <strong>In Our Excel Workflow:</strong><br>
                        We populate the "VM extId" column by querying the API first, then use these stable identifiers for all subsequent operations.
                    </div>
                </div>
            </div>

            <div class="slide-counter">6 / 12</div>
        </div>

        <!-- Slide 7: ETags and Concurrency -->
        <div class="slide">
            <h1>ETags: Ensuring Data Consistency</h1>
            <h2>Optimistic Locking in Distributed Systems</h2>
            
            <h3>What is an ETag?</h3>
            <div class="highlight">
                <strong>ETag (Entity Tag):</strong> A unique identifier for a specific version of a resource. It changes every time the resource is modified, enabling concurrency control without locks.
            </div>

            <div class="workflow-box">
                <h3>The ETag Workflow</h3>
                <p><span class="step-number">1</span><strong>GET Request:</strong> Retrieve resource and its current ETag</p>
                <p><span class="step-number">2</span><strong>Prepare Update:</strong> Build your modification payload</p>
                <p><span class="step-number">3</span><strong>POST/PUT with If-Match:</strong> Include ETag in If-Match header</p>
                <p><span class="step-number">4</span><strong>Server Validation:</strong> Server checks if ETag matches current version</p>
                <p><span class="step-number">5</span><strong>Success or Conflict:</strong> Operation succeeds or returns 412 if resource changed</p>
            </div>

            <div class="two-column">
                <div>
                    <h3>Why ETags Matter</h3>
                    <ul>
                        <li><strong>Prevent Lost Updates:</strong> Two users can't overwrite each other's changes</li>
                        <li><strong>Data Integrity:</strong> Ensures you're modifying the version you think you are</li>
                        <li><strong>Performance:</strong> No need for resource locks</li>
                        <li><strong>Conflict Detection:</strong> Graceful handling of concurrent modifications</li>
                    </ul>
                </div>
                <div>
                    <h3>Implementation in Our Scripts</h3>
                    <div class="code-block">
# 1. GET to retrieve ETag
vm_etag = response.headers.get('ETag', '')

# 2. Prepare headers for POST
post_headers = {
    'Authorization': auth_header,
    'If-Match': vm_etag,
    'NTNX-Request-Id': str(uuid.uuid4()),
    'Content-Type': 'application/json'
}

# 3. POST with ETag validation
response = requests.post(url, 
    headers=post_headers, 
    json=payload)
                    </div>
                </div>
            </div>

            <div class="slide-counter">7 / 12</div>
        </div>

        <!-- Slide 8: Excel as UI -->
        <div class="slide">
            <h1>Excel as User Interface</h1>
            <h2>Making API Automation User-Friendly</h2>
            
            <h3>Why Excel?</h3>
            <div class="two-column">
                <div>
                    <ul>
                        <li><strong>Familiar Interface:</strong> Everyone knows Excel</li>
                        <li><strong>Data Validation:</strong> Built-in dropdown lists, formulas</li>
                        <li><strong>Bulk Operations:</strong> Process hundreds of VMs at once</li>
                        <li><strong>Visual Feedback:</strong> Color-coded status updates</li>
                        <li><strong>Audit Trail:</strong> Permanent record of changes</li>
                        <li><strong>Easy Review:</strong> Stakeholder approval before execution</li>
                    </ul>
                </div>
                <div>
                    <div class="excel-demo">
                        <h4>Our Workbook Structure</h4>
                        <p><strong>üìä ToUpdate Sheet:</strong><br>
                        ‚Ä¢ VM Name & ExtId<br>
                        ‚Ä¢ Categories to assign<br>
                        ‚Ä¢ Validation status<br>
                        ‚Ä¢ Execution results</p>
                        
                        <p><strong>üìã VMCategories Sheet:</strong><br>
                        ‚Ä¢ All VMs and current categories<br>
                        ‚Ä¢ Reference for existing assignments</p>
                        
                        <p><strong>üè∑Ô∏è AllCategories Sheet:</strong><br>
                        ‚Ä¢ Master list of available categories<br>
                        ‚Ä¢ Category names and ExtIds</p>
                    </div>
                </div>
            </div>

            <h3>Data Validation Features</h3>
            <table>
                <tr>
                    <th>Validation Type</th>
                    <th>Implementation</th>
                    <th>Benefit</th>
                </tr>
                <tr>
                    <td>Category Names</td>
                    <td>Dropdown from AllCategories sheet</td>
                    <td>Prevents typos, ensures valid categories</td>
                </tr>
                <tr>
                    <td>Format Checking</td>
                    <td>PowerShell validation: "key=value,key=value"</td>
                    <td>Catches syntax errors before API calls</td>
                </tr>
                <tr>
                    <td>VM Existence</td>
                    <td>Cross-reference with VMCategories sheet</td>
                    <td>Ensures VM ExtIds are valid</td>
                </tr>
                <tr>
                    <td>Status Tracking</td>
                    <td>Color-coded cells (Green=OK, Red=Error)</td>
                    <td>Visual feedback on validation results</td>
                </tr>
            </table>

            <div class="slide-counter">8 / 12</div>
        </div>

        <!-- Slide 9: Workflow Overview -->
        <div class="slide">
            <h1>Complete Automation Workflow</h1>
            <h2>From Data Collection to Execution</h2>
            
            <div class="workflow-box">
                <h3>Phase 1: Data Discovery & Preparation</h3>
                <p><span class="step-number">1</span><strong>list_vms.ps1:</strong> Query Nutanix API for all VMs, extract names and ExtIds</p>
                <p><span class="step-number">2</span><strong>list_categories.ps1:</strong> Fetch all available categories and their ExtIds</p>
                <p><span class="step-number">3</span><strong>build_workbook.ps1:</strong> Create Excel workbook with current VM-category mappings</p>
            </div>

            <div class="api-flow">
                <h3>Phase 2: User Input & Validation</h3>
                <p><span class="step-number">4</span><strong>User edits Excel:</strong> Specify VMs and desired category assignments</p>
                <p><span class="step-number">5</span><strong>update_vm_categories.ps1:</strong> Validate all entries against API data</p>
                <ul style="margin-left: 50px;">
                    <li>Verify VM ExtIds exist and are unique</li>
                    <li>Validate category names match available categories</li>
                    <li>Check syntax of category assignments</li>
                    <li>Update Excel with validation results</li>
                </ul>
            </div>

            <div class="excel-demo">
                <h3>Phase 3: API Execution</h3>
                <p><span class="step-number">6</span><strong>update_categories_for_vm.py:</strong> Execute API calls for validated entries</p>
                <ul style="margin-left: 50px;">
                    <li>For each VM with "OK" validation status:</li>
                    <li>GET VM details and extract current ETag</li>
                    <li>POST category associations with ETag in If-Match header</li>
                    <li>Update Excel with execution results and timestamps</li>
                </ul>
            </div>

            <div class="slide-counter">9 / 12</div>
        </div>

        <!-- Slide 10: Script Deep Dive -->
        <div class="slide">
            <h1>Script Implementation Details</h1>
            <h2>PowerShell and Python Working Together</h2>
            
            <div class="two-column">
                <div>
                    <h3>PowerShell Scripts</h3>
                    <div class="code-block">
# Basic Auth Header Creation
$base64Auth = [System.Convert]::ToBase64String(
    [System.Text.Encoding]::ASCII.GetBytes(
        "$($username):$($password)"
    )
)
$headers = @{
    Authorization = "Basic $base64Auth"
}

# API Call with Error Handling
$response = Invoke-RestMethod -Uri $uri 
    -Method Get -Headers $headers 
    -SkipCertificateCheck
                    </div>
                    
                    <h4>Key PowerShell Features Used:</h4>
                    <ul>
                        <li><strong>ImportExcel Module:</strong> Excel file manipulation</li>
                        <li><strong>Invoke-RestMethod:</strong> HTTP API calls</li>
                        <li><strong>ConvertTo-Json/From-Json:</strong> Data serialization</li>
                        <li><strong>Hash Tables:</strong> Efficient data lookups</li>
                    </ul>
                </div>
                <div>
                    <h3>Python Implementation</h3>
                    <div class="code-block">
# Authentication Header
credentials = f"{username}:{password}"
encoded = b64encode(credentials.encode('ascii'))
auth_header = f'Basic {encoded.decode('ascii')}'

# ETag-aware POST Request
post_headers = {
    'Authorization': auth_header,
    'If-Match': vm_etag,
    'NTNX-Request-Id': str(uuid.uuid4()),
    'Content-Type': 'application/json'
}

response = requests.post(url, 
    headers=post_headers, json=payload)
                    </div>
                    
                    <h4>Key Python Libraries:</h4>
                    <ul>
                        <li><strong>requests:</strong> HTTP client for API calls</li>
                        <li><strong>pandas:</strong> Excel file reading/writing</li>
                        <li><strong>openpyxl:</strong> Excel formatting and styles</li>
                        <li><strong>uuid:</strong> Generate request IDs</li>
                    </ul>
                </div>
            </div>

            <div class="highlight">
                <strong>Design Choice:</strong> PowerShell excels at Windows integration and Excel manipulation, while Python provides robust HTTP handling and data processing. Using both languages leverages their respective strengths.
            </div>

            <div class="slide-counter">10 / 12</div>
        </div>

        <!-- Slide 11: Error Handling -->
        <div class="slide">
            <h1>Robust Error Handling</h1>
            <h2>Planning for the Unexpected</h2>
            
            <h3>Multi-Layer Validation Strategy</h3>
            <div class="workflow-box">
                <h4>Pre-Flight Validation (PowerShell)</h4>
                <ul>
                    <li><strong>Syntax Checking:</strong> Verify "key=value" format for categories</li>
                    <li><strong>Reference Validation:</strong> Ensure VM ExtIds exist in current data</li>
                    <li><strong>Uniqueness Checks:</strong> Detect duplicate VM entries</li>
                    <li><strong>Category Validation:</strong> Verify category names exist in master list</li>
                </ul>
            </div>

            <div class="api-flow">
                <h4>Runtime Error Handling (Python)</h4>
                <div class="code-block">
try:
    response = requests.post(url, headers=headers, json=payload, timeout=30)
    
    if response.status_code == 202:
        # Success - update Excel with green status
        update_excel_status(file, sheet, row, 'ACCEPTED', timestamp)
    elif response.status_code == 412:
        # ETag conflict - resource was modified by another process
        update_excel_status(file, sheet, row, 'CONFLICT', timestamp)
    else:
        # Other error - log details for troubleshooting
        update_excel_status(file, sheet, row, f'ERROR {response.status_code}', timestamp)
        
except requests.exceptions.Timeout:
    update_excel_status(file, sheet, row, 'TIMEOUT', timestamp)
except requests.exceptions.ConnectionError:
    update_excel_status(file, sheet, row, 'CONNECTION_ERROR', timestamp)
                </div>
            </div>

            <div class="two-column">
                <div>
                    <h3>Common Error Scenarios</h3>
                    <ul>
                        <li><strong>Network Issues:</strong> Timeouts, connection failures</li>
                        <li><strong>Authentication:</strong> Invalid credentials, expired tokens</li>
                        <li><strong>Resource Changes:</strong> VM deleted, categories modified</li>
                        <li><strong>Concurrency:</strong> ETag conflicts from parallel operations</li>
                        <li><strong>Input Errors:</strong> Malformed data, missing fields</li>
                    </ul>
                </div>
                <div>
                    <h3>Recovery Strategies</h3>
                    <div class="excel-demo">
                        <p><strong>Automatic Retry:</strong> Implement exponential backoff for transient failures</p>
                        <p><strong>Partial Success:</strong> Continue processing other VMs even if some fail</p>
                        <p><strong>Clear Feedback:</strong> Update Excel with specific error codes and timestamps</p>
                        <p><strong>Audit Trail:</strong> Log all API interactions for troubleshooting</p>
                    </div>
                </div>
            </div>

            <div class="slide-counter">11 / 12</div>
        </div>

        <!-- Slide 12: Best Practices -->
        <div class="slide">
            <h1>Best Practices & Key Takeaways</h1>
            <h2>Building Production-Ready API Automation</h2>
            
            <div class="two-column">
                <div>
                    <h3>API Design Principles</h3>
                    <ul>
                        <li><strong>Always use ETags:</strong> Prevent concurrent modification issues</li>
                        <li><strong>Include Request IDs:</strong> Enable request tracing and debugging</li>
                        <li><strong>Handle all status codes:</strong> Plan for success and failure scenarios</li>
                        <li><strong>Implement timeouts:</strong> Don't let requests hang indefinitely</li>
                        <li><strong>Use HTTPS:</strong> Secure all API communications</li>
                        <li><strong>Validate inputs early:</strong> Catch errors before making API calls</li>
                    </ul>
                    
                    <h3>User Experience</h3>
                    <ul>
                        <li><strong>Familiar interfaces:</strong> Excel is universally understood</li>
                        <li><strong>Visual feedback:</strong> Color-coded status indicators</li>
                        <li><strong>Dry-run capability:</strong> Preview changes before execution</li>
                        <li><strong>Clear documentation:</strong> Examples and error explanations</li>
                    </ul>
                </div>
                <div>
                    <h3>Production Considerations</h3>
                    <div class="workflow-box">
                        <h4>Security</h4>
                        <ul>
                            <li>Store credentials securely (avoid hardcoding)</li>
                            <li>Use service accounts with minimum required permissions</li>
                            <li>Enable audit logging for all operations</li>
                        </ul>
                        
                        <h4>Scalability</h4>
                        <ul>
                            <li>Implement rate limiting to avoid API throttling</li>
                            <li>Use batch operations where available</li>
                            <li>Consider parallel processing for large datasets</li>
                        </ul>
                        
                        <h4>Monitoring</h4>
                        <ul>
                            <li>Log all API interactions with timestamps</li>
                            <li>Track success/failure rates</li>
                            <li>Set up alerts for abnormal patterns</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="highlight">
                <h3>üéØ Key Takeaway</h3>
                <p><strong>Modern API automation succeeds when it combines technical robustness with user-friendly interfaces.</strong> By understanding REST fundamentals, leveraging ExtIds and ETags properly, and providing familiar tools like Excel for user interaction, we can build automation that is both powerful and accessible to non-technical users.</p>
            </div>

            <div style="text-align: center; margin-top: 40px; color: #2a5298; font-size: 1.3em;">
                <strong>Thank you for your attention!</strong><br>
                <em>Questions & Discussion</em>
            </div>

            <div class="slide-counter">12 / 12</div>
        </div>

    </div>

    <div class="navigation">
        <button class="nav-btn" onclick="previousSlide()">&lt; Previous</button>
        <button class="nav-btn" onclick="nextSlide()">Next &gt;</button>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');
            
            // Update navigation buttons
            const prevBtn = document.querySelector('.nav-btn:first-child');
            const nextBtn = document.querySelector('.nav-btn:last-child');
            
            prevBtn.disabled = currentSlide === 0;
            nextBtn.disabled = currentSlide === totalSlides - 1;
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                showSlide(currentSlide + 1);
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                showSlide(currentSlide - 1);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                previousSlide();
            }
        });

        // Initialize
        showSlide(0);
    </script>
</body>
</html>